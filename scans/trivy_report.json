{
  "SchemaVersion": 2,
  "CreatedAt": "2025-11-21T13:15:00.3393981-05:00",
  "ArtifactName": "polylab",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": "ec2_alarms_template.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 32,
        "Failures": 13
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:155-167",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 155,
            "EndLine": 167,
            "Code": {
              "Lines": [
                {
                  "Number": 155,
                  "Content": "  PrivateInstanceAz1:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateInstanceAz1\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 160,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 161,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 162,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 163,
                  "Content": "      SubnetId: !Ref 'PrivateSubnetAz1'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PrivateSubnetAz1'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 164,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:168-180",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 168,
            "EndLine": 180,
            "Code": {
              "Lines": [
                {
                  "Number": 168,
                  "Content": "  PrivateInstanceAz2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateInstanceAz2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 170,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 171,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 172,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 173,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 174,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 175,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 176,
                  "Content": "      SubnetId: !Ref 'PrivateSubnetAz2'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PrivateSubnetAz2'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 177,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:211-223",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 211,
            "EndLine": 223,
            "Code": {
              "Lines": [
                {
                  "Number": 211,
                  "Content": "  PublicInstanceAz1:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicInstanceAz1\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 212,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 219,
                  "Content": "      SubnetId: !Ref 'PublicSubnetAz1'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PublicSubnetAz1'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 220,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:224-236",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 224,
            "EndLine": 236,
            "Code": {
              "Lines": [
                {
                  "Number": 224,
                  "Content": "  PublicInstanceAz2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicInstanceAz2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 226,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 227,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 228,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 229,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 230,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 231,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 232,
                  "Content": "      SubnetId: !Ref 'PublicSubnetAz2'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PublicSubnetAz2'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 233,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "InstanceSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 122,
            "EndLine": 122,
            "Code": {
              "Lines": [
                {
                  "Number": 118,
                  "Content": "  InstanceSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mInstanceSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "        - CidrIp: '0.0.0.0/0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m'0.0.0.0/0'",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 138,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "InstanceSecurityGroup",
                "Filename": "ec2_alarms_template.yaml",
                "Location": {
                  "StartLine": 118,
                  "EndLine": 139
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "InstanceSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 127,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 118,
                  "Content": "  InstanceSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mInstanceSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        - CidrIp: '0.0.0.0/0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m'0.0.0.0/0'",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 138,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "InstanceSecurityGroup",
                "Filename": "ec2_alarms_template.yaml",
                "Location": {
                  "StartLine": 118,
                  "EndLine": 139
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:155-167",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 155,
            "EndLine": 167,
            "Code": {
              "Lines": [
                {
                  "Number": 155,
                  "Content": "  PrivateInstanceAz1:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateInstanceAz1\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 160,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 161,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 162,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 163,
                  "Content": "      SubnetId: !Ref 'PrivateSubnetAz1'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PrivateSubnetAz1'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 164,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:168-180",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 168,
            "EndLine": 180,
            "Code": {
              "Lines": [
                {
                  "Number": 168,
                  "Content": "  PrivateInstanceAz2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateInstanceAz2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 170,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 171,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 172,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 173,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 174,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 175,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 176,
                  "Content": "      SubnetId: !Ref 'PrivateSubnetAz2'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PrivateSubnetAz2'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 177,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:211-223",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 211,
            "EndLine": 223,
            "Code": {
              "Lines": [
                {
                  "Number": 211,
                  "Content": "  PublicInstanceAz1:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicInstanceAz1\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 212,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 219,
                  "Content": "      SubnetId: !Ref 'PublicSubnetAz1'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PublicSubnetAz1'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 220,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:224-236",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 224,
            "EndLine": 236,
            "Code": {
              "Lines": [
                {
                  "Number": 224,
                  "Content": "  PublicInstanceAz2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicInstanceAz2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 226,
                  "Content": "      IamInstanceProfile: LabInstanceProfile",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIamInstanceProfile\u001b[0m: LabInstanceProfile",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 227,
                  "Content": "      ImageId: !Ref 'AmiId'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: !Ref 'AmiId'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 228,
                  "Content": "      InstanceType: !Ref 'InstanceType'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: !Ref 'InstanceType'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 229,
                  "Content": "      KeyName: !Ref 'KeyName'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mKeyName\u001b[0m: !Ref 'KeyName'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 230,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 231,
                  "Content": "        - !Ref 'InstanceSecurityGroup'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref 'InstanceSecurityGroup'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 232,
                  "Content": "      SubnetId: !Ref 'PublicSubnetAz2'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnetId\u001b[0m: !Ref 'PublicSubnetAz2'",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 233,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnetAz1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 248,
            "EndLine": 248,
            "Code": {
              "Lines": [
                {
                  "Number": 244,
                  "Content": "  PublicSubnetAz1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnetAz1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "      AvailabilityZone: !Ref 'AZ1'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Ref 'AZ1'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "      CidrBlock: 10.0.0.0/24",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.0.0\u001b[0m/24",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 249,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "          Value: public-az1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: public-az1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 252,
                  "Content": "      VpcId: !Ref 'PolystudentVpc'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref 'PolystudentVpc'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 253,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnetAz1",
                "Filename": "ec2_alarms_template.yaml",
                "Location": {
                  "StartLine": 244,
                  "EndLine": 253
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnetAz2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 258,
            "EndLine": 258,
            "Code": {
              "Lines": [
                {
                  "Number": 254,
                  "Content": "  PublicSubnetAz2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnetAz2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "      AvailabilityZone: !Ref 'AZ2'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Ref 'AZ2'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "      CidrBlock: 10.0.1.0/24",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.1.0\u001b[0m/24",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 258,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 259,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 260,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 261,
                  "Content": "          Value: public-az2",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: public-az2",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 262,
                  "Content": "      VpcId: !Ref 'PolystudentVpc'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref 'PolystudentVpc'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 263,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnetAz2",
                "Filename": "ec2_alarms_template.yaml",
                "Location": {
                  "StartLine": 254,
                  "EndLine": 263
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2_alarms_template.yaml:146-154",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 146,
            "EndLine": 154,
            "Code": {
              "Lines": [
                {
                  "Number": 146,
                  "Content": "  PolystudentVpc:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentVpc\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      CidrBlock: 10.0.0.0/16",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.0.0\u001b[0m/16",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "      EnableDnsHostnames: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEnableDnsHostnames\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "      EnableDnsSupport: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mEnableDnsSupport\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "      Tags:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        - Key: Name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          Value: polystudent-vpc-ec2-alarms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: polystudent-vpc-ec2-alarms",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "    Type: AWS::EC2::VPC",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::VPC",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "s3_template.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 42,
        "Failures": 5
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3_template.yaml:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "  Polystudents3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudents3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    DeletionPolicy: Retain",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mDeletionPolicy\u001b[0m: Retain",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      AccessControl: Private",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAccessControl\u001b[0m: Private",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      BucketEncryption:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketEncryption\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ServerSideEncryptionConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mServerSideEncryptionConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          - ServerSideEncryptionByDefault:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mServerSideEncryptionByDefault\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              KMSMasterKeyID: !Ref 'KmsKeyArn'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mKMSMasterKeyID\u001b[0m: !Ref 'KmsKeyArn'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              SSEAlgorithm: aws:kms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mSSEAlgorithm\u001b[0m: aws:kms",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3_template.yaml:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "  Polystudents3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudents3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    DeletionPolicy: Retain",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mDeletionPolicy\u001b[0m: Retain",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      AccessControl: Private",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAccessControl\u001b[0m: Private",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      BucketEncryption:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketEncryption\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ServerSideEncryptionConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mServerSideEncryptionConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          - ServerSideEncryptionByDefault:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mServerSideEncryptionByDefault\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              KMSMasterKeyID: !Ref 'KmsKeyArn'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mKMSMasterKeyID\u001b[0m: !Ref 'KmsKeyArn'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              SSEAlgorithm: aws:kms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mSSEAlgorithm\u001b[0m: aws:kms",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3_template.yaml:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "  Polystudents3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudents3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    DeletionPolicy: Retain",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mDeletionPolicy\u001b[0m: Retain",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      AccessControl: Private",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAccessControl\u001b[0m: Private",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      BucketEncryption:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketEncryption\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ServerSideEncryptionConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mServerSideEncryptionConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          - ServerSideEncryptionByDefault:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mServerSideEncryptionByDefault\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              KMSMasterKeyID: !Ref 'KmsKeyArn'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mKMSMasterKeyID\u001b[0m: !Ref 'KmsKeyArn'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              SSEAlgorithm: aws:kms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mSSEAlgorithm\u001b[0m: aws:kms",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3_template.yaml:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "  Polystudents3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudents3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    DeletionPolicy: Retain",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mDeletionPolicy\u001b[0m: Retain",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      AccessControl: Private",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAccessControl\u001b[0m: Private",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      BucketEncryption:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketEncryption\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ServerSideEncryptionConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mServerSideEncryptionConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          - ServerSideEncryptionByDefault:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mServerSideEncryptionByDefault\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              KMSMasterKeyID: !Ref 'KmsKeyArn'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mKMSMasterKeyID\u001b[0m: !Ref 'KmsKeyArn'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              SSEAlgorithm: aws:kms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mSSEAlgorithm\u001b[0m: aws:kms",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3_template.yaml:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "  Polystudents3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudents3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    DeletionPolicy: Retain",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mDeletionPolicy\u001b[0m: Retain",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      AccessControl: Private",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAccessControl\u001b[0m: Private",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      BucketEncryption:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketEncryption\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ServerSideEncryptionConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mServerSideEncryptionConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          - ServerSideEncryptionByDefault:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mServerSideEncryptionByDefault\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "              KMSMasterKeyID: !Ref 'KmsKeyArn'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mKMSMasterKeyID\u001b[0m: !Ref 'KmsKeyArn'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "              SSEAlgorithm: aws:kms",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mSSEAlgorithm\u001b[0m: aws:kms",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "vpc_flowlogs_template.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnet",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 44,
            "EndLine": 44,
            "Code": {
              "Lines": [
                {
                  "Number": 41,
                  "Content": "  PublicSubnet:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "      CidrBlock: 10.0.1.0/24",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.1.0\u001b[0m/24",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "          Value: public-subnet-group9",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: public-subnet-group9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "      VpcId: !Ref 'PolystudentVPC'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref 'PolystudentVPC'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet",
                "Filename": "vpc_flowlogs_template.yaml",
                "Location": {
                  "StartLine": 41,
                  "EndLine": 49
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "vpc_template.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 34,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 90,
            "EndLine": 90,
            "Code": {
              "Lines": [
                {
                  "Number": 86,
                  "Content": "  PolystudentSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        - CidrIp: '0.0.0.0/0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m'0.0.0.0/0'",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 142,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentSecurityGroup",
                "Filename": "vpc_template.yaml",
                "Location": {
                  "StartLine": 86,
                  "EndLine": 143
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 95,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 86,
                  "Content": "  PolystudentSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        - CidrIp: '0.0.0.0/0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m'0.0.0.0/0'",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 142,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentSecurityGroup",
                "Filename": "vpc_template.yaml",
                "Location": {
                  "StartLine": 86,
                  "EndLine": 143
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PolystudentSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 127,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 86,
                  "Content": "  PolystudentSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        - CidrIp: '0.0.0.0/0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m'0.0.0.0/0'",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 142,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PolystudentSecurityGroup",
                "Filename": "vpc_template.yaml",
                "Location": {
                  "StartLine": 86,
                  "EndLine": 143
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnet1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 233,
            "EndLine": 233,
            "Code": {
              "Lines": [
                {
                  "Number": 229,
                  "Content": "  PublicSubnet1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 230,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 233,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 239,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 240,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet1",
                "Filename": "vpc_template.yaml",
                "Location": {
                  "StartLine": 229,
                  "EndLine": 240
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnet2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 250,
            "EndLine": 250,
            "Code": {
              "Lines": [
                {
                  "Number": 246,
                  "Content": "  PublicSubnet2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet2",
                "Filename": "vpc_template.yaml",
                "Location": {
                  "StartLine": 246,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "vpc_template.yaml:144-154",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 144,
            "EndLine": 154,
            "Code": {
              "Lines": [
                {
                  "Number": 144,
                  "Content": "  PolystudentVpc:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPolystudentVpc\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "      CidrBlock: !Ref 'VpcCidr'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref 'VpcCidr'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "      EnableDnsHostnames: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEnableDnsHostnames\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      EnableDnsSupport: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mEnableDnsSupport\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "      Tags:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        - Key: Name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "          Value: polystudent-vpc-py",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: polystudent-vpc-py",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "        - Key: Project",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Project",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 153,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
